const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t,this.score=0,this.status="idle"}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}start(){this.board=this.generateNewTile(this.generateNewTile(this.board)),this.score=0,this.status="playing"}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing"}generateNewTile(t){let e=[];for(let s=0;s<t.length;s++)for(let r=0;r<t[s].length;r++)0===t[s][r]&&e.push({x:s,y:r});if(e.length>0){let{x:s,y:r}=e[Math.floor(Math.random()*e.length)];t[s][r]=.9>Math.random()?2:4}return t}moveLeft(){this.board=this.combine(this.slide(this.board)),this.board=this.generateNewTile(this.board)}moveRight(){this.board=this.reverse(this.board),this.moveLeft(),this.board=this.reverse(this.board)}moveUp(){this.board=this.transpose(this.board),this.moveLeft(),this.board=this.transpose(this.board)}moveDown(){this.board=this.transpose(this.board),this.moveRight(),this.board=this.transpose(this.board)}slide(t){return t.map(t=>{let e=t.filter(t=>t),s=Array(4-e.length).fill(0);return e.concat(s)})}combine(t){for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length-1;s++)t[e][s]===t[e][s+1]&&0!==t[e][s]&&(t[e][s]*=2,t[e][s+1]=0,this.score+=t[e][s]);return t}reverse(t){return t.map(t=>t.reverse())}transpose(t){return t[0].map((e,s)=>t.map(t=>t[s]))}};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".button.start"),s=document.querySelector(".game-score"),r=document.querySelector(".game-field"),a=document.querySelector(".message-start"),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");function n(){s.textContent=t.getScore();let e=t.getState(),n=r.getElementsByTagName("td");for(let t=0;t<n.length;t++){let s=Math.floor(t/4),r=t%4,a=e[s][r];n[t].className="field-cell",0!==a?(n[t].classList.add(`field-cell--${a}`),n[t].textContent=a):n[t].textContent=""}"win"===t.getStatus()?(o.classList.remove("hidden"),i.classList.add("hidden"),a.classList.add("hidden")):"lose"===t.getStatus()?(i.classList.remove("hidden"),o.classList.add("hidden"),a.classList.add("hidden")):(o.classList.add("hidden"),i.classList.add("hidden"))}function d(){for(let t of r.getElementsByTagName("td"))t.className="field-cell",t.textContent="";e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),a.classList.remove("hidden"),n()}e.addEventListener("click",()=>{"Start"===e.textContent?(t.start(),e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),a.classList.add("hidden"),n()):(t.restart(),e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),d())}),document.addEventListener("keydown",e=>{if("playing"!==t.getStatus())return;let s=!1;switch(e.key){case"ArrowLeft":t.moveLeft(),s=!0;break;case"ArrowRight":t.moveRight(),s=!0;break;case"ArrowUp":t.moveUp(),s=!0;break;case"ArrowDown":t.moveDown(),s=!0}s&&(n(),!function(t){for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(0===t[e][s]||3!==e&&t[e][s]===t[e+1][s]||3!==s&&t[e][s]===t[e][s+1])return!0;return!1}(t.getState())&&(t.status="lose",n()),function(t){for(let e of t)if(e.includes(2048))return!0;return!1}(t.getState())&&(t.status="win",n()))}),d()});
//# sourceMappingURL=index.c4565245.js.map
